/*! rhapsody-control 2014-05-29 */
rcontrol={connect:function(){"use strict";rcontrol.session=io("http://127.0.0.1:8001/rhapsody"),rcontrol.session.on("connect_failed",function(){console.log("rhapsody-control connect failed"),rcontrol.timer=setTimeout(rcontrol.connect,3e4)}),rcontrol.session.on("connect",function(){console.log("rhapsody-control connected"),rcontrol.timer&&clearTimeout(rcontrol.timer)}),rcontrol.session.on("control",function(a){switch(a){case"pause":"none"==$("#player-play").css("display")?($("#player-pause").click(),rcontrol.notify("Pause")):($("#player-play").click(),rcontrol.notify("Play"));break;case"next":$("#player-next").click();break;case"prev":$("#player-previous").click();break;case"shuffle":$("#player-shuffle").click(),rcontrol.notify("Shuffle");break;default:console.log(a)}})},getArtist:function(){"use strict";return $("#player-artist-link").text()},getTrack:function(){"use strict";return $("#player-track-link").text()},getArtistAndTrack:function(){"use strict";var a=rcontrol.getArtist(),b=rcontrol.getTrack(),c=" - ";return b?[a,b].join(c):"Nothing is playing"},notify:function(a,b){"use strict";var c={},d=$(".player-album-thumbnail:nth-child(3)").find("img");c.title=b||"Rhapsody",c.description=a||rcontrol.getArtistAndTrack(),c.sticky=!1,d.attr("title")&&(c.icon=d.attr("src")),window.fluid.showGrowlNotification(c)},observeTrackChange:function(){"use strict";console.log("rhapsody-control observeTrackChange"),rcontrol.trackChangeObserver&&rcontrol.trackChangeObserver.disconnect(),rcontrol.trackChangeObserver=new MutationObserver(function(a){a[0].oldValue!=rcontrol.currentTrack&&(rcontrol.currentTrack=a[0].oldValue,rcontrol.notify(rcontrol.getArtist(),rcontrol.getTrack()))});var a=$("#player-track-link").get(0);rcontrol.trackChangeObserver.observe(a,{attributes:!0,attributeOldValue:!0,attributeFilter:["title"]})},observe:function(){"use strict";console.log("rhapsody-control observe"),$("#player-track-link").length>0?rcontrol.observeTrackChange():setTimeout(function(){rcontrol.observe()},1e3)},init:function(){"use strict";console.log("rhapsody-control init"),jQuery.getScript("http://127.0.0.1:8002/js/socket.io.min.js",rcontrol.connect),rcontrol.observe()}},rcontrol.init();