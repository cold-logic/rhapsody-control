/*! rhapsody-control 2014-08-28 */
var rcontrol;rcontrol={connect:function(){"use strict";rcontrol.session=io("http://127.0.0.1:8001/rhapsody"),rcontrol.session.on("connect_failed",function(){console.log("rhapsody-control connect failed"),rcontrol.timer=setTimeout(rcontrol.connect,3e4)}),rcontrol.session.on("connect",function(){console.log("rhapsody-control connected"),rcontrol.timer&&clearTimeout(rcontrol.timer)}),rcontrol.session.on("control",function(a){rcontrol.do(a)})},"do":function(a){var b,c,d,e;switch(Rhapsody?(b=function(){Rhapsody.queueController.isPlaying?Rhapsody.queueController.pause():Rhapsody.queueController.resume()},c=function(){Rhapsody.queueController.isPlaying&&Rhapsody.queueController.playNext()},d=function(){Rhapsody.queueController.isPlaying&&Rhapsody.queueController.playPrevious()},e=function(){Rhapsody.queueController.toggleShuffle()}):(b=function(){"none"==$("#player-play").css("display")?($("#player-pause").click(),rcontrol.notify("Pause")):$("#player-play").click()},c=function(){$("#player-next").click()},d=function(){$("#player-previous").click()},e=function(){$("#player-shuffle").click()}),a){case"play":b(),rcontrol.notify("Play");break;case"next":c(),rcontrol.notify("Next");break;case"previous":d(),rcontrol.notify("Previous");break;case"shuffle":e(),rcontrol.notify("Shuffle");break;default:b()}},getArtist:function(){"use strict";return $("#player-artist-link").text()},getTrack:function(){"use strict";return $("#player-track-link").text()},getArtistAndTrack:function(){"use strict";var a=rcontrol.getArtist(),b=rcontrol.getTrack(),c=" - ";return b?[a,b].join(c):"Nothing is playing"},notify:function(a,b){"use strict";var c={},d=$(".player-album-thumbnail:nth-child(3)").find("img");c.title=b||"Rhapsody",c.description=a||rcontrol.getArtistAndTrack(),c.sticky=!1,d.attr("title")&&(c.icon=d.attr("src")),window.fluid.showGrowlNotification(c)},observeTrackChange:function(){"use strict";console.log("rhapsody-control observeTrackChange"),rcontrol.trackChangeObserver&&rcontrol.trackChangeObserver.disconnect(),rcontrol.trackChangeObserver=new MutationObserver(function(a){a[0].oldValue!=rcontrol.currentTrack&&(rcontrol.currentTrack=a[0].oldValue,rcontrol.notify(rcontrol.getArtist(),rcontrol.getTrack()))});var a=$("#player-track-link").get(0);rcontrol.trackChangeObserver.observe(a,{attributes:!0,attributeOldValue:!0,attributeFilter:["title"]})},observe:function(){"use strict";console.log("rhapsody-control observe"),$("#player-track-link").length>0?rcontrol.observeTrackChange():setTimeout(function(){rcontrol.observe()},1e3)},init:function(){"use strict";console.log("rhapsody-control init"),jQuery.getScript("http://127.0.0.1:8002/js/socket.io.min.js",rcontrol.connect),rcontrol.observe()}},rcontrol.init();